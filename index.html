<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… Ø¯ÙŠØ³ÙƒÙˆØ±Ø¯</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background-color: #0f1115;
      color: #fff;
      margin: 0;
      padding: 20px;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
    }
    .page {
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
      flex-direction: column;
    }
    .card {
      background: #151821;
      border: 1px solid #23283a;
      border-radius: 14px;
      padding: 18px;
      width: min(800px, 95vw);
      box-shadow: 0 8px 20px rgba(0, 0, 0, .35);
      margin-bottom: 15px;
    }
    h2, h3, h4 {
      margin: .2rem 0 1rem;
    }
    input, textarea, select, button {
      width: 100%;
      box-sizing: border-box;
      margin-bottom: 8px;
    }
    input, textarea, select {
      background: #0c0f16;
      color: #fff;
      border: 1px solid #2a3046;
      border-radius: 10px;
      padding: 10px 12px;
      outline: 0;
    }
    textarea {
      resize: vertical;
      min-height: 80px;
    }
    button {
      background: #3867ff;
      border: 0;
      border-radius: 10px;
      padding: 10px 12px;
      font-weight: 600;
      cursor: pointer;
    }
    button.secondary {
      background: #2b2f3f;
    }
    .status {
      font-size: .9rem;
      opacity: .85;
    }
    .toast {
      position: fixed;
      right: 16px;
      bottom: 16px;
      padding: 10px 14px;
      border-radius: 10px;
      background: #2b2f3f;
      color: #fff;
      z-index: 9999;
    }
    .toast.success {
      background: #2b7a3e;
    }
    .toast.error {
      background: #a83a3a;
    }
  </style>
</head>
<body>

<div id="login-page" class="page">
  <div class="card">
    <h2>ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</h2>
    <input type="text" id="discord-token" placeholder="Ø£Ø¯Ø®Ù„ ØªÙˆÙƒÙ† Discord">
    <button id="login-btn">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</button>
    <div id="alert" class="toast error" style="display:none;">Ø§Ù„ØªÙˆÙƒÙ† ØºÙŠØ± ØµØ­ÙŠØ­</div>
  </div>
</div>

<div id="dashboard" class="page" style="display:none;">
  <div class="card">
    <h3>Ù…Ø±Ø­Ø¨Ù‹Ø§ Ø¨Ùƒ ÙÙŠ Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</h3>
    <p id="user-name">Ù…Ø±Ø­Ø¨Ù‹Ø§! Ù…Ù† ÙØ¶Ù„Ùƒ Ù‚Ù… Ø¨ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</p>
    <button id="logout-btn" class="secondary">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬</button>
  </div>

  <div class="card">
    <h4>Ø¥Ø±Ø³Ø§Ù„ Ø±Ø³Ø§Ù„Ø©</h4>
    <input type="text" id="channel-id" placeholder="Channel ID">
    <textarea id="message-content" placeholder="Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø±Ø³Ø§Ù„Ø©"></textarea>
    <button id="send-once-btn">Ø¥Ø±Ø³Ø§Ù„ Ù…Ø±Ø© ÙˆØ§Ø­Ø¯Ø©</button>
  </div>

  <div class="card">
    <h4>Ø³Ø¨Ø§Ù… Ø§Ù„Ø±Ø³Ø§Ø¦Ù„</h4>
    <input type="text" id="spam-channel-id" placeholder="Channel ID">
    <textarea id="spam-message-content" placeholder="Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø³Ø¨Ø§Ù…"></textarea>
    <input type="number" id="spam-count" placeholder="Ø¹Ø¯Ø¯ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„" min="1">
    <input type="number" id="spam-interval" placeholder="Ø§Ù„ÙØ§ØµÙ„ Ø§Ù„Ø²Ù…Ù†ÙŠ (Ù…Ù„Ù„ÙŠ Ø«Ø§Ù†ÙŠØ©)" min="100">
    <button id="start-spam-btn">Ø¨Ø¯Ø¡ Ø§Ù„Ø³Ø¨Ø§Ù…</button>
    <button id="stop-spam-btn" class="secondary">Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ø³Ø¨Ø§Ù…</button>
    <div id="spam-status" class="status"></div>
  </div>

  <div class="card">
    <h4>ØªØºÙŠÙŠØ± Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø­Ø³Ø§Ø¨</h4>
    <input type="text" id="username-input" placeholder="Ø§Ø³Ù… Ø§Ù„Ø­Ø³Ø§Ø¨ Ø§Ù„Ø¬Ø¯ÙŠØ¯">
    <textarea id="bio-input" placeholder="Ø§Ù„Ø¨Ø§ÙŠÙˆ Ø§Ù„Ø¬Ø¯ÙŠØ¯"></textarea>
    <select id="status-select">
      <option value="online">ğŸŸ¢ Online</option>
      <option value="idle">ğŸŒ™ Idle</option>
      <option value="dnd">â›” DND</option>
      <option value="invisible">âš« Invisible</option>
    </select>
    <input type="file" id="avatar-input" accept="image/*">
    <button id="update-profile-btn">ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø­Ø³Ø§Ø¨</button>
  </div>
</div>

<script>
let discordToken = null, spamTimer = null, spamRunning = false;

function showToast(msg, type) {
  const t = document.createElement('div');
  t.className = `toast ${type || ''}`;
  t.textContent = msg;
  document.body.appendChild(t);
  setTimeout(() => t.remove(), 2500);
}

async function verifyToken(token) {
  try {
    const res = await fetch("https://discord.com/api/v10/users/@me", {
      headers: { 'Authorization': `Bot ${token}` }
    });
    if (!res.ok) return null;
    return await res.json();
  } catch { return null; }
}

document.getElementById('login-btn').addEventListener('click', async () => {
  const t = (document.getElementById('discord-token').value || '').trim();
  if (!t) return showToast('Ø£Ø¯Ø®Ù„ Ø§Ù„ØªÙˆÙƒÙ†', 'error');
  showToast('Ø¬Ø§Ø±Ù Ø§Ù„ØªØ­Ù‚Ù‚...', '');
  const user = await verifyToken(t);
  if (!user) {
    showToast('Ø§Ù„ØªÙˆÙƒÙ† ØºÙŠØ± ØµØ­ÙŠØ­', 'error');
    return;
  }
  discordToken = t;
  document.getElementById('login-page').style.display = 'none';
  document.getElementById('dashboard').style.display = 'flex';
  document.getElementById('user-name').textContent = `Ù…Ø±Ø­Ø¨Ù‹Ø§ ${user.username}`;
  showToast(`Ù…Ø±Ø­Ø¨Ù‹Ø§ ${user.username}`, 'success');
});

// Ø¥Ø±Ø³Ø§Ù„ Ø±Ø³Ø§Ù„Ø© ÙˆØ§Ø­Ø¯Ø©
document.getElementById('send-once-btn').addEventListener('click', async () => {
  const cid = (document.getElementById('channel-id').value || '').trim();
  const content = (document.getElementById('message-content').value || '').trim();
  if (!discordToken) return showToast('Ø³Ø¬Ù‘Ù„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø£ÙˆÙ„Ø§Ù‹', 'error');
  if (!cid || !content) return showToast('Ø£ÙƒÙ…Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª', 'error');
  
  const response = await sendMessage(cid, content);
  if (response.success) {
    showToast('ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø±Ø³Ø§Ù„Ø©', 'success');
  } else {
    showToast('ÙØ´Ù„ ÙÙŠ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø±Ø³Ø§Ù„Ø©', 'error');
  }
});

// Ø¥Ø±Ø³Ø§Ù„ Ø³Ø¨Ø§Ù…
document.getElementById('start-spam-btn').addEventListener('click', async () => {
  const cid = (document.getElementById('spam-channel-id').value || '').trim();
  const content = (document.getElementById('spam-message-content').value || '').trim();
  const count = parseInt(document.getElementById('spam-count').value, 10);
  const interval = parseInt(document.getElementById('spam-interval').value, 10);

  if (!discordToken) return showToast('Ø³Ø¬Ù‘Ù„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø£ÙˆÙ„Ø§Ù‹', 'error');
  if (!cid || !content || !count || !interval) return showToast('Ø£ÙƒÙ…Ù„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø³Ø¨Ø§Ù…', 'error');
  if (spamRunning) return showToast('Ø§Ù„Ø³Ø¨Ø§Ù… ÙŠØ¹Ù…Ù„ Ø¨Ø§Ù„ÙØ¹Ù„', 'error');
  
  spamRunning = true;
  let remaining = count;
  updateSpamStatus(`Ø¨Ø¯Ø¡ Ø§Ù„Ø³Ø¨Ø§Ù…... Ø§Ù„Ø¹Ø¯Ø¯ Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ: ${remaining}`);
  
  spamTimer = setInterval(async () => {
    if (!spamRunning) return;
    if (remaining <= 0) {
      stopSpam();
      updateSpamStatus('Ø§ÙƒØªÙ…Ù„ Ø§Ù„Ø³Ø¨Ø§Ù…');
      showToast('ØªÙ… Ø§Ù„Ø§Ù†ØªÙ‡Ø§Ø¡ Ù…Ù† Ø§Ù„Ø³Ø¨Ø§Ù…', 'success');
      return;
    }
    const response = await sendMessage(cid, content);
    if (!response.success) {
      stopSpam();
      updateSpamStatus('ØªÙ… Ø§Ù„Ø¥ÙŠÙ‚Ø§Ù Ø¨Ø³Ø¨Ø¨ Ø®Ø·Ø£');
      showToast('Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ø³Ø¨Ø§Ù…', 'error');
      return;
    }
    remaining--;
    updateSpamStatus(`Ø¬Ø§Ø±Ù Ø§Ù„Ø¥Ø±Ø³Ø§Ù„... Ø§Ù„Ø¹Ø¯Ø¯ Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ: ${remaining}`);
  }, interval);

  showToast('Ø¨Ø¯Ø£ Ø§Ù„Ø³Ø¨Ø§Ù…', 'success');
});

// Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ø³Ø¨Ø§Ù…
document.getElementById('stop-spam-btn').addEventListener('click', () => {
  stopSpam();
  updateSpamStatus('ØªÙ… Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ø³Ø¨Ø§Ù…');
  showToast('ØªÙ… Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ø³Ø¨Ø§Ù…', 'success');
});

// Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ø³Ø¨Ø§Ù…
function stopSpam() {
  if (spamTimer) clearInterval(spamTimer);
  spamTimer = null;
  spamRunning = false;
}

// ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„Ø³Ø¨Ø§Ù…
function updateSpamStatus(text) {
  document.getElementById('spam-status').textContent = text || '';
}

// Ø¥Ø±Ø³Ø§Ù„ Ø±Ø³Ø§Ù„Ø© Ø¹Ø¨Ø± API
async function sendMessage(cid, content) {
  try {
    const res = await fetch(`https://discord.com/api/v10/channels/${cid}/messages`, {
      method: 'POST',
      headers: {
        'Authorization': `Bot ${discordToken}`,
        'Content-Type': 'application/json'
      },
      body: JSON.stringify({ content })
    });

    if (res.status === 429) {
      const data = await res.json();
      const retry = Math.ceil((data.retry_after || 1) * 1000);
      await new Promise(r => setTimeout(r, retry));
      return await sendMessage(cid, content);
    }

    if (!res.ok) {
      return { success: false };
    }
    return { success: true };
  } catch {
    return { success: false };
  }
}
</script>
</body>
</html>
